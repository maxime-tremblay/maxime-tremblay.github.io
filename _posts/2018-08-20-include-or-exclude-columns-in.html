---
layout: post
title: Include or Exclude Columns in an Interactive Report Export
date: '2018-08-20T15:21:00.002-04:00'
author: Maxime Tremblay
tags: 
modified_time: '2018-08-20T15:21:21.086-04:00'
thumbnail: https://3.bp.blogspot.com/-0NcDGlcjJN8/W3dyJcUMwJI/AAAAAAAACNo/czwSOF88RzoIabx5kCJ6jyp_zcJci19xgCLcBGAs/s72-c/IR_download.png
blogger_id: tag:blogger.com,1999:blog-267713902572011003.post-4254931350533953239
blogger_orig_url: https://max-tremblay.blogspot.com/2018/08/include-or-exclude-columns-in.html
---

<div class="separator" style="clear: both; display: none; text-align: center;"><a href="https://3.bp.blogspot.com/-0NcDGlcjJN8/W3dyJcUMwJI/AAAAAAAACNo/czwSOF88RzoIabx5kCJ6jyp_zcJci19xgCLcBGAs/s1600/IR_download.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="588" data-original-width="774" height="243" src="https://3.bp.blogspot.com/-0NcDGlcjJN8/W3dyJcUMwJI/AAAAAAAACNo/czwSOF88RzoIabx5kCJ6jyp_zcJci19xgCLcBGAs/s320/IR_download.png" width="320" /></a></div>You might have noticed that for the Classic Reports and the Interactive Grids there's an option to include or exclude a column in the report's export.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--dC18rR57p0/W3cj0STJD8I/AAAAAAAACNE/KuVoEclTvP0e6aZoSJpgb6yiS0H4x_zcACLcBGAs/s1600/include_in_export.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="181" data-original-width="672" height="86" src="https://1.bp.blogspot.com/--dC18rR57p0/W3cj0STJD8I/AAAAAAAACNE/KuVoEclTvP0e6aZoSJpgb6yiS0H4x_zcACLcBGAs/s320/include_in_export.png" width="320" /></a></div><br />Unfortunately, that option is not available&nbsp;for the Interactive Reports.<br /><br />In order to export a report, APEX submits the page using a request that is then used to generate the corresponding file. This can be verified by having a look at the network tab in DevTools:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-bTb13qAgnS4/W3dqbC4r7zI/AAAAAAAACNU/p_6Dqs86YAIT2KQX1CNQupSb8qMj0c3lgCLcBGAs/s1600/IR_request.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="705" data-original-width="1600" height="175" src="https://1.bp.blogspot.com/-bTb13qAgnS4/W3dqbC4r7zI/AAAAAAAACNU/p_6Dqs86YAIT2KQX1CNQupSb8qMj0c3lgCLcBGAs/s400/IR_request.png" width="400" /></a></div><br />As we can see, a request&nbsp;is used to export the report, except for the Email option.<br /><br />If we look at the request's details for the Email export:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-p7fzu17wGEo/W3dqbID0N-I/AAAAAAAACNQ/LuRMDeHuEwwzzQK3eWrpQ_bs7Dec6Nw9QCLcBGAs/s1600/IR_request_email.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1279" data-original-width="1600" height="318" src="https://3.bp.blogspot.com/-p7fzu17wGEo/W3dqbID0N-I/AAAAAAAACNQ/LuRMDeHuEwwzzQK3eWrpQ_bs7Dec6Nw9QCLcBGAs/s400/IR_request_email.png" width="400" /></a></div><br />We can see that it's making an AJAX call and that it sets the <i>p_widget_action</i> to "SEND_EMAIL" which is saved in the wwv_flow package as g_widget_action.<br /><br />Using the above, we can remove a column from the export by adding a server-side condition that checks the request and the widget action as follow:<br /><br /><pre class="line-numbers"><code class="language-sql">nvl(:request, 'EMPTY') not in ('CSV','XLS','PDF','RTF','HTMLD')<br />and nvl(wwv_flow.g_widget_action, 'EMPTY') &lt;&gt; 'SEND_EMAIL'</code></pre><br />That condition will work if there is only one interactive report on the page. If there is more than one report, the requests will be different.<br /><br />As we can see here:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-U_8MwCFUv1s/W3dyqiPWzRI/AAAAAAAACNw/12z8P_KHGtQ8ywA1WurWK-urBNCaj-TRgCLcBGAs/s1600/IR_request_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="863" data-original-width="1600" height="215" src="https://4.bp.blogspot.com/-U_8MwCFUv1s/W3dyqiPWzRI/AAAAAAAACNw/12z8P_KHGtQ8ywA1WurWK-urBNCaj-TRgCLcBGAs/s400/IR_request_2.png" width="400" /></a></div><br />The requests are going to be using this pattern:<br /><pre><code class="language-none">IR[R&lt;region id&gt;]_&lt;export type&gt;</code></pre><br />If we take that into consideration and include it into the previous condition, we will have this:<br /><br /><pre class="line-numbers"><code class="language-sql">nvl(substr(:request, instr(:request, '_', -1) + 1), 'EMPTY') not in ('CSV','XLS','PDF','RTF','HTMLD')<br />and nvl(wwv_flow.g_widget_action, 'EMPTY') &lt;&gt; 'SEND_EMAIL'</code></pre><br />In order to centralize the condition and avoid code being duplicated/replicated everywhere that we need to use this, it's best to create an authorization schema that we can use instead of using the server-side condition. <br /><br />Enjoy!